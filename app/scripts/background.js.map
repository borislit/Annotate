{"version":3,"sources":["../scripts.babel/background.js"],"names":[],"mappings":"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","file":"background.js","sourcesContent":["'use strict';\r\n\r\nconst BASE_URL = 'http://rest.goltsman.net/annotate';\r\n\r\nclass TabManager {\r\n  static executeForActiveTab(fn) {\r\n    chrome.tabs.query({active: true, currentWindow: true}, fn);\r\n  }\r\n}\r\n\r\nclass MessagingService {\r\n  static registerListeners() {\r\n    chrome.runtime.onMessage.addListener(MessagingService.handleIncomingMessage);\r\n  }\r\n\r\n  static handleIncomingMessage() {\r\n    console.log('Got message');\r\n  }\r\n\r\n  static sendRuntimeMessage(data) {\r\n    chrome.runtime.sendMessage(data, () => {\r\n      console.log('Response received for runtime');\r\n    });\r\n  }\r\n\r\n  static sendTabMessage(data) {\r\n    chrome.tabs.onUpdated.addListener(function (tabId, changeInfo) {\r\n      if (changeInfo.status === 'complete') {\r\n        TabManager.executeForActiveTab(tabs => {\r\n          chrome.tabs.sendMessage(tabs[0].id, data, function (response) {\r\n            console.log(response, 'Tab message response received');\r\n          });\r\n        });\r\n      }\r\n    });\r\n  }\r\n}\r\n\r\nclass ApiManager {\r\n\r\n  constructor() {\r\n\r\n  }\r\n\r\n  static getGroupsList() {\r\n    TabManager.executeForActiveTab(tabs => {\r\n      const currentURL = tabs[0].url;\r\n      return jQuery.get(`${BASE_URL}/groups?uri=?uri=${currentURL}`).then((data) => {\r\n        MessagingService.sendRuntimeMessage(data.groups);\r\n      });\r\n    });\r\n  }\r\n\r\n  static getByGroupsList() {\r\n    TabManager.executeForActiveTab(tabs => {\r\n      console.log(tabs);\r\n      const currentURL = \"https://en.wikipedia.org/wiki/Infection\";//tabs[0].url;\r\n      return jQuery.get(`${BASE_URL}/group/bgu?uri=?uri=#{currentURL}`).then((data) => {\r\n        console.log(data);\r\n      });\r\n    });\r\n  }\r\n\r\n  static addAnnotation() {\r\n    TabManager.executeForActiveTab(tabs => {\r\n      console.log(tabs);\r\n      const currentURL = tabs[0].url;\r\n      return jQuery.post(`${BASE_URL}/add`).then((data) => {\r\n        console.log(data);\r\n      });\r\n    });\r\n  }\r\n\r\n  static vote() {\r\n    TabManager.executeForActiveTab(tabs => {\r\n      console.log(tabs);\r\n      const currentURL = tabs[0].url;\r\n      return jQuery.post(`${BASE_URL}/vote?uri=?uri=#{currentURL}`).then((data) => {\r\n        console.log(data);\r\n      });\r\n    });\r\n  }\r\n}\r\n\r\nMessagingService.registerListeners();\r\n\r\nconsole.log('\\'Allo \\'Allo! Event Page for Page Action Yo');\r\n"]}