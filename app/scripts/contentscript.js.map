{"version":3,"sources":["../scripts.babel/contentscript.js"],"names":[],"mappings":"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","file":"contentscript.js","sourcesContent":["'use strict';\r\n\r\nconsole.log('\\'Allo \\'Allo! Content script is up');\r\n\r\n\r\nvar ContentController =  {\r\n  _onSyncCallback : _.noop,\r\n  _data : [\r\n    {\r\n      quote: \"Welcome to Wikipedia\",\r\n      \"text\" : \"demo\",\r\n      \"ranges\" : [\r\n        {\r\n          end: \"/div[4]/table[1]/tbody[1]/tr[1]/td[1]/table[1]/tbody[1]/tr[1]/td[1]/div[1]/a[1]\",\r\n          endOffset: 9,\r\n          start: \"/div[4]/table[1]/tbody[1]/tr[1]/td[1]/table[1]/tbody[1]/tr[1]/td[1]/div[1]\",\r\n          startOffset: 0\r\n        }\r\n      ]\r\n    }\r\n  ],\r\n\r\n  // listen to sync events\r\n  onSync : function(callback) {\r\n    ContentController._onSyncCallback = function() { callback(_.clone(ContentController._data))};\r\n    chrome.runtime.sendMessage({apiManger: \"search\"}, function(response) {\r\n      console.log(response.farewell);\r\n    });\r\n  },\r\n\r\n  // request sync\r\n  fetch : function() {\r\n    setTimeout(ContentController._onSyncCallback, 500);\r\n    chrome.runtime.sendMessage({apiManger: \"search\"}, function(response) {\r\n      console.log(response.farewell);\r\n    });\r\n  },\r\n\r\n  // send updated data\r\n  update : function(model) {\r\n    console.info(\"an annotation has just been updated!\", model);\r\n  },\r\n\r\n  // send new model\r\n  create : function(model) {\r\n    ContentController._data.push({\r\n      quote : model.quote,\r\n      text : model.text,\r\n      ranges : _.clone(model.ranges)\r\n    });\r\n\r\n    ContentController._onSyncCallback();\r\n    console.info(\"an annotation has just been created!\", model);\r\n  },\r\n\r\n  // send deleted model\r\n  destroy : function(model) {\r\n    ContentController._data = _.without(ContentController._data, model);\r\n\r\n    ContentController._onSyncCallback();\r\n    console.info(\"an annotation has just been deleted!\", model);\r\n  }\r\n};\r\n\r\nAnnotator.Plugin.Content = function() {\r\n  console.log(\"constructor\");\r\n\r\n  return {\r\n    pluginInit : function() {\r\n      console.log('content plugin loaded');\r\n\r\n      this.annotator.subscribe(\"annotationCreated\", ContentController.create);\r\n      this.annotator.subscribe(\"annotationUpdated\", ContentController.update);\r\n      this.annotator.subscribe(\"annotationDeleted\", ContentController.destroy);\r\n\r\n      ContentController.onSync(this.annotator.loadAnnotations.bind(this.annotator));\r\n      ContentController.fetch();\r\n\r\n      return this;\r\n    }\r\n  };\r\n};\r\n\r\njQuery(function ($) {\r\n  $('.mw-body-content').annotator();\r\n\r\n  });\r\n\r\nAnnotator.Plugin.Content = function() {\r\n  console.log(\"constructor\");\r\n\r\n  return {\r\n    pluginInit : function() {\r\n      console.log('content plugin loaded');\r\n\r\n      this.annotator.subscribe(\"annotationCreated\", ContentController.create);\r\n      this.annotator.subscribe(\"annotationUpdated\", ContentController.update);\r\n      this.annotator.subscribe(\"annotationDeleted\", ContentController.destroy);\r\n\r\n      ContentController.onSync(this.annotator.loadAnnotations.bind(this.annotator));\r\n      ContentController.fetch();\r\n\r\n      return this;\r\n    }\r\n  };\r\n};\r\n\r\njQuery(function ($) {\r\n  console.log('Up & Running...');\r\n\r\n  $('.mw-body-content').annotator().annotator('addPlugin', \"Content\");\r\n  $(\"body\");\r\n});\r\n"]}