{"version":3,"sources":["../scripts.babel/categories.js"],"names":[],"mappings":"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","file":"categories.js","sourcesContent":["// jshint ignore: start\r\n// Generated by CoffeeScript 1.10.0\r\n(function() {\r\n  var bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; },\r\n    extend = function(child, parent) { for (var key in parent) { if (hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; },\r\n    hasProp = {}.hasOwnProperty,\r\n    indexOf = [].indexOf || function(item) { for (var i = 0, l = this.length; i < l; i++) { if (i in this && this[i] === item) return i; } return -1; };\r\n\r\n  Annotator.Plugin.Categories = (function(superClass) {\r\n    extend(Categories, superClass);\r\n\r\n    Categories.prototype.options = {\r\n      categories: [],\r\n      categoryColorClasses: {},\r\n      categoryClass: \"annotator-category\",\r\n      classForSelectedCategory: \"annotator-category-selected\",\r\n      emptyCategory: \"Highlight\",\r\n      annotatorHighlight: 'span.annotator-hl'\r\n    };\r\n\r\n    Categories.prototype.events = {\r\n      '.annotator-category click': \"changeSelectedCategory\",\r\n      'annotationEditorSubmit': \"saveCategory\",\r\n      'annotationEditorShown': \"highlightSelectedCategory\",\r\n      'annotationsLoaded': 'changeHighlightColors'\r\n    };\r\n\r\n    Categories.prototype.field = null;\r\n\r\n    Categories.prototype.input = null;\r\n\r\n    Categories.prototype.widthSet = false;\r\n\r\n    Categories.prototype.pluginInit = function() {\r\n      if (!Annotator.supported()) {\r\n        return;\r\n      }\r\n      this.options.categoryColorClasses[this.options.emptyCategory] = this.options.categoryClass + '-none';\r\n      this.field = this.annotator.editor.addField({\r\n        label: Annotator._t('Category'),\r\n        options: this.options\r\n      });\r\n      $(document).delegate(\".annotator-category\", \"tap\", {\r\n        preventDefault: false\r\n      }, this.changeSelectedCategory);\r\n      this.annotator.viewer.addField({\r\n        load: this.updateViewer,\r\n        options: this.options\r\n      });\r\n      return this.input = $(this.field).find(':input');\r\n    };\r\n\r\n    function Categories(element, options) {\r\n      this.changeSelectedCategory = bind(this.changeSelectedCategory, this);\r\n      Categories.__super__.constructor.call(this, element, options);\r\n      this.element = element;\r\n    }\r\n\r\n    Categories.prototype.changeHighlightColors = function(annotations) {\r\n      var annotation, category, cssClass, highlight, i, j, k, len, len1, ref, results;\r\n      i = 0;\r\n      ref = this.options.categories;\r\n      for (j = 0, len = ref.length; j < len; j++) {\r\n        category = ref[j];\r\n        cssClass = this.options.categoryClass + '-' + i;\r\n        this.options.categoryColorClasses[category] = cssClass;\r\n        i++;\r\n      }\r\n      results = [];\r\n      for (k = 0, len1 = annotations.length; k < len1; k++) {\r\n        annotation = annotations[k];\r\n        if ((annotation.category == null) || !annotation.category.length) {\r\n          annotation.category = this.options.emptyCategory;\r\n        }\r\n        results.push((function() {\r\n          var l, len2, ref1, results1;\r\n          ref1 = annotation.highlights;\r\n          results1 = [];\r\n          for (l = 0, len2 = ref1.length; l < len2; l++) {\r\n            highlight = ref1[l];\r\n            results1.push($(highlight).addClass(this.options.categoryColorClasses[annotation.category]));\r\n          }\r\n          return results1;\r\n        }).call(this));\r\n      }\r\n      return results;\r\n    };\r\n\r\n    Categories.prototype.setSelectedCategory = function(currentCategory) {\r\n      $(this.field).find('.annotator-category').removeClass(this.options.classForSelectedCategory);\r\n      return $(this.field).find('.annotator-category:contains(' + currentCategory + ')').addClass(this.options.classForSelectedCategory);\r\n    };\r\n\r\n    Categories.prototype.updateViewer = function(field, annotation) {\r\n      var ref;\r\n      field = $(field);\r\n      field.addClass(this.options.categoryClass).html(this.options.emptyCategory);\r\n      if ((annotation.category != null) && annotation.category.length > 0) {\r\n        field.addClass(this.options.categoryClass).html(annotation.category);\r\n        if (ref = annotation.category, indexOf.call(this.options.categories, ref) >= 0) {\r\n          return field.addClass(this.options.categoryColorClasses[annotation.category]);\r\n        }\r\n      }\r\n    };\r\n\r\n    Categories.prototype.changeSelectedCategory = function(event) {\r\n      var category;\r\n      category = $(event.target).html();\r\n      return this.setSelectedCategory(category);\r\n    };\r\n\r\n    Categories.prototype.saveCategory = function(event, annotation) {\r\n      annotation.category = $(this.field).find('.' + this.options.classForSelectedCategory).html();\r\n      if ((annotation.text != null) && annotation.text.length > 0 && (annotation.category == null)) {\r\n        window.alert('You did not choose a category, so the default has been chosen.');\r\n        annotation.category = this.options.categories[0];\r\n      }\r\n      if ((annotation.category == null) || !annotation.text) {\r\n        annotation.category = this.options.emptyCategory;\r\n      }\r\n      return this.changeHighlightColors([annotation]);\r\n    };\r\n\r\n    Categories.prototype.highlightSelectedCategory = function(event, annotation) {\r\n      var category, categoryHTML, j, len, ref, totalWidth;\r\n      if (annotation.category == null) {\r\n        annotation.category = this.options.emptyCategory;\r\n      }\r\n      categoryHTML = \"\";\r\n      ref = this.options.categories;\r\n      for (j = 0, len = ref.length; j < len; j++) {\r\n        category = ref[j];\r\n        categoryHTML += '<span class=\"' + this.options.categoryClass;\r\n        categoryHTML += ' ' + this.options.categoryColorClasses[category] + '\">';\r\n        categoryHTML += category;\r\n        categoryHTML += '</span>';\r\n      }\r\n      $(this.field).html(categoryHTML);\r\n      if (!this.widthSet) {\r\n        this.widthSet = true;\r\n        totalWidth = 5;\r\n        $(\"span.annotator-category\").each(function(index) {\r\n          totalWidth += parseInt($(this).outerWidth(true), 10);\r\n        });\r\n        $(\".annotator-editor .annotator-widget\").width(totalWidth);\r\n      }\r\n      return this.setSelectedCategory(annotation.category);\r\n    };\r\n\r\n    return Categories;\r\n\r\n  })(Annotator.Plugin);\r\n\r\n}).call(this);\r\n"]}